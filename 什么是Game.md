# 第一节

去年物理课，笔者被要求分析2020诺贝尔物理学奖，今天整个新活，来玩玩2020诺贝尔经济学奖相关理论——拍卖理论。在此之前，我们先来聊聊，Game。

## 什么是Game

本质上，就是研究智能体之间合作与竞争的数学模型。game的组成要素有：player玩家、strategy策略、outcome结果、objective function目标函数、repeated/one-shot轮次。

需要注意的是结果与目标函数的异同：例如一群人在一起玩游戏，他们需要给一个数字，最终猜到他们所有数的平均数的2/3的人获得胜利，那么结果是输赢，目标函数则是平均数的2/3。我们在之后的例子中会更好的阐明这一个区别。

## 囚徒困境

最经典的Game就是囚徒困境啦，当然没有了解过的同学笔者也大概写写。

两个囚徒被捕，被分开关进两个房间，无法互相沟通。他们面临坦白或者沉默两个选择。但若双方坦白，双方各判8年；一方坦白一方沉默，则坦白的一方判1年，另一方判10年；双方沉默，则均判2年。

我们不妨设两人为A、B，不妨以A的视角来看看囚徒困境：

若B沉默，坦白判1年、沉默判2年，则显然选择坦白获刑更少；

若B坦白，坦白判8年、沉默判10年，则显然选择坦白获刑更少。

看来，A选择坦白，收益更大。那么B显然更倾向于选择坦白，最终两人均判8年。

但是，两人的最优解是什么呢？显然是均沉默，最终各获2年的判刑即为两人的最优解。但是，在分开的房间里，谁都不知道对方会不会叛变，因此都会趋向于坦白。当然，如果对方彼此知道对方正在坦白或沉默，就不会出现囚徒困境了。

## 纳什均衡

我们来回顾一下囚徒困境中如何得到双方都趋向于坦白这一结论的：我们固定了对方的策略，从而选择最优的策略，发现无论怎么固定对方策略，最优策略都是一致（即坦白），最终得到了两人会趋向于选择坦白。这样的思路所得到的结果就是一种纳什均衡（Nash Equilibrium），更严格来说，是纯策略纳什均衡。但需要注意，*固定了对方的策略，从而选择最优的策略，发现无论怎么固定对方策略，最优策略都是一致*并非纳什均衡的定义，这比纳什均衡更严格，被称为占优策略解。

我们用更为数学的定义来看纳什均衡。先定义一些符号。

策略：设$S_i$为第$i$个人可选择的策略集合，$s_i\in S_i$为其中的某一种策略。所有人的策略即为$S=S_1\times S_2\times \dots\times S_n$，式中乘号显然为笛卡尔积（如果不知道什么是笛卡尔乘积，可以重修高数一），$s\in S$表示其中的一种策略，即$s=(s_1,s_2,\dots,s_n)$，记$s_{-i}=(s_1,s_2,\dots,s_{i-1},s_{i+1},\dots,s_n)$，那么$s = (s_i,s_{-i})$。

目标函数：每个人都需要优化一个函数，如果恒为正称为收益函数，恒为负则为费用函数。第$i$个人使用策略$s$的收益记为$u_i(s)$（费用则为$c_i(s)$）。

定义完基本概念后，我们可以思考，怎样用符号语言表达一个策略对第$i$个人是占优的呢？我们不妨看看：
$$
\forall s^{'}_i,s^{'}_{-i},有u_i(s_i,s^{'}_{-i})\geq u_i(s^{'}_i,s^{'}_{-i})
$$
即对于$s_i$而言，无论自己的策略怎么变，只要在给定的别人的策略下，自己就能利用策略$s_i$获得更高的收益。需要注意的是，固定的是别人的策略，但是一定要穷举。这里可以利用囚徒困境来进行理解。

但是，对于大多数时候，我们并不一定有占优的策略，我们再给出最优反应的定义：
$$
\forall s^{'}_i\in S_i,有u_i(s_i,s_{-i})\geq u_i(s^{'}_i,s_{-i})
$$
称$s_i$为参与人$i$的最优反应。这个其实很好想，就是如果固定了别人的策略，如果当前策略比任意其它策略都好，那就是最优反应。

这样，我们给出纳什均衡的定义：对于一个策略$s\in S$,如果对于任意一个参与者$i$，都有$s_i$为最优反应，则称该策略为**纯粹策略纳什均衡（Pure Strategy Nash Equilibrium)**。或可直接称为纳什均衡。

简单来说，假设两个参与者A、B，若A选x时B选择y是最优的，同时B选择y是A选择x时最优的，则$s=(x,y)$即为纳什均衡。

纳什均衡的形成，说明了当前任何人改变策略都不会带来任何好处，因此一旦形成纳什均衡，人们都乐于保持当前状态。

## ”小组摸鱼定理“

我们来一道例题，以便于更好理解之前的几个概念。

假设有$n$个学生组成一个小组进行小组作业，每个人可以选择认真完成作业或者摸鱼。如果认真完成作业，那么需要承担2单位的做作业成本。若选择摸鱼，则会对同组的每个同学造成1单位的损失，在这里每个人都想最小化自己的损失。试问每个人的最优策略是什么。

**分析**：定义若对于第$i$个参与者认真写作业$s_i=1$，摸鱼$s_i=0$，则其损失为：
$$
cost_i(s) = 2s_i+\sum_{j=1}^n(1-s_j)
$$
化简后得：
$$
cost_i(s)=s_i+n-\sum_{j\ne i}s_j
$$
那么为了最小化损失，显然第$i$个人趋向于摸鱼。此即为”小组摸鱼定理“。此时显然是纳什均衡。

所以每个人都会趋向于摸鱼。$\square$

我们来想想为什么会出现大家都喜欢摸鱼。首先，完成作业和摸鱼带来的损失不成比例，即完成作业的代价高于摸鱼的代价。但仔细想想，这里的假设较为合理，因为如果组内少数人选择摸鱼，则非摸鱼者承受的代价一定大于其摸鱼的损失的。其次，单纯假设每个人的目标函数并不合理，因为不同参与者的目标是不一样的，你要保研，他要工作，不同人对成绩的要求并非相同的，因此单纯假设不是十分合理的。

我们这里在想的时候，也可以补充囚徒困境的部分，即不同人的目标函数可能不同，比如如果是一对母子，那么可能会导致母亲的目标函数是最小化孩子的入狱时间等等，因此不应该简单定义。

## 机制设计

我们可以看到，在”小组摸鱼定理“中，由于摸鱼与分数的规则制定不合理，导致每个参与者最终的策略并不是规则制定者所希望的，那么如何正确的设计一个游戏规则呢？我们来看看我们从第一段就埋下的坑——拍卖，来了解如何设计一个由多个策略型参与者组成的系统，使这个系统有良好的性能。

让我们从最简单的拍卖——单物品拍卖开始，先对拍卖进行建模。首先是每个人对于待拍的物品有一个估值$v_i$，并且这个估值是一个私人信息，别的竞拍者以及拍卖这在结果出现之前并不知道。对于每个竞拍者，我们假设其使用的效用模型为*拟线性效用模型*。即：如果竞拍者没有胜利，则效用为0；若胜利且成交价为$p$，则效用为$v_i-p$。这个模型既符合实际，也非常简单，我们在后续的描述中都会使用该模型。

我们再来看一个概念：密封价格拍卖。首先每个竞拍者会**私下**将他的报价提供给卖家，之后由卖家决定谁能够得到物品，最终由卖家决定价格。显然，我们会倾向于选择报价最高的卖家得到物品，这是收益最大化所要求的，在本文中所有获胜竞拍者都会这么做。而决定卖出价格，则有很多选择方法，但不同的选择会对竞拍者的选择产生较大的影响，例如不要钱，那么游戏就变成谁的数字最大了。

我们先看最简单的密封一价拍卖，即获胜竞拍者支付价格即为其报价。这种拍卖十分常见，但难以预测。可以证明一价拍卖没有占优策略，且不一定每一个人选择如是告诉自己的私有信息等。因此一价拍卖推理的必要性很低。

我们来讨论密封二价拍卖。这种拍卖形式又称为维克里拍卖，在这种形式中，获胜竞拍者只需要支付第二高报价。可以证明的是，每个人报价都是估值$v_i$时，即为占优策略。即对于$s_i$而言，无论自己的策略怎么变，只要在给定的别人的策略下，自己就能利用策略$s_i$获得更高的收益。我们来进行简单证明。

**证明**：

固定除第$i$个人的报价，设除第$i$个人最大报价为$V$，则若：

​	$V>v_i$，则失败，由定义效用为0。若减小或增大，收益永远小于等于0

​	$V\leq v_i$，则成功，收益为$v_i-V\geq 0$，且如果报价更高，收益仍不变，报价更低，收益不变或变为0。

综上，该策略是占优的。$\square$

可见，在密封二价拍卖中，每一个竞拍者按照自己的估值真实报价都是一个占优策略，且收益非负，称这种机制**占优策略激励相容**（Dominant-Strategy Incentive Compatible, DSIC）。这是密封二价拍卖的**强动机保证**，因为这使得对拍卖结果的推测更为简单了，只需要出内心估值就行。（需要注意的是，收益非负是个体理性的要求，但教科书写在一起了，这里也没有进行更改）

同时，它的社会福利可以最大化。我们定义在拍卖中，社会福利为：
$$
\sum_{i=1}^{n}v_ix_i
$$
式中$x_i$若第$i$个人胜利为1，否则为0。那么显然，密封二价拍卖保证了每个人说真话能导致最大的社会福利，就称该拍卖是**社会福利最大化**或**诚实**（truthfullness）的。这是密封二价拍卖的**高性能保证**，即使卖家不知道竞拍者估值，也能在拍卖中选择出最高估值的竞拍者。

并且，他的计算是多项式时间内的，因此计算高效。这一部分可以参考算法设计与分析课程的相关内容了解多项式时间对于算法的重要性。

总结下，我们认为**二价拍卖是理想化的**，因为它是DSIC的，是社会福利最大化的，是计算高效的。

## 小结

这是这个新坑的第一节，希望大家喜欢。我们首先介绍了博弈的概念，通过囚徒困境引入了纳什均衡。根据之前所提到的东西，自己推出了小组摸鱼定理，理解了机制设计的重要性，并通过密封二价拍卖，知道了设计一个好的拍卖需要的三个性质——DSIC，社会福利最大化和计算高效。下一节我们将首先继续讨论一个较为复杂的例子继续理解机制设计，并介绍迈尔森引理，并继续讨论算法机制设计——对于对算法党很熟悉的背包问题，但在博弈论中有别的算法。 

# 第二节

## 关键字搜索竞价拍卖

我们考虑一个经典的拍卖：关键字搜索竞价拍卖。在这种拍卖中，

假设某个搜索结果页面上有 $k$ 个广告链接位置，将拍卖出售给不同类型的广告主。设第 $k$ 个广告位的点击率分别为$\alpha_1,\alpha_2,\dots,\alpha_k$ ；同时，设广告主对每一次点击有一个估值$v_i$，那么广告主$i$在广告位$j$处的期望就是$v_i\alpha_j$。

如何实现一个理想的拍卖方式，使之能够(1) DSIC（**占优策略激励相容**：每一个竞拍者按照自己的估值真实报价都是一个占优策略，且收益非负）；(2) 社会福利$\sum v_ix_i$最大化（这里实际上$x_i$就是分配给第$i$个人分配的广告位的点击率$\alpha_k$；(3) 计算高效（算法$\in P$）。

我们先满足后两个性质：将点击率排序，把第$i$高的广告位分配给出价第$i$高的竞拍者。排序显然为$\Omega(n\log n)$，计算高效，并且根据排序不等式可证明社会福利最大化。

那么来看看怎么满足DSIC。这里就需要介绍迈尔森引理。

我们先回顾上一节机制设计中的几个问题，设计者需要决定：谁嬴得拍卖？赢者出什么价格？这两个决策被称为分配规则与支付规则。

在密封二价拍卖中首先需要收集所有人的出价$b=(b_1,b_2,\dots,b_n)$，其中$b$被称为出价向量。然后选择一个可行的分配$x(b)\in X \sube R^n$，这个分配是出价向量的函数。再选择一个支付规则$p(b)\in R^n$，也是出价向量的函数。



