# 模式识别

## 贝叶斯决策理论

### 基本符号与定义

**决策**：根据观测到的x，利用先验和类条件概率决定x属于哪一类。

**Bayes决策:**
$$
p(\omega_i |x)=\frac{p(x|\omega_i)p(\omega_i)}{p(x)}
$$
**决策规则**
$$
p(\omega_i|x) = \max_{j=1,2}p(\omega_j|x),x\in \omega_i
$$
等价形式：
$$
p(x|\omega_i)p(\omega_i) = \max_{j=1,2}p(x|\omega_j)p(\omega_i)
$$


$$
若l(x)=\frac{p(x|\omega_1)}{p(x|\omega_2)}< \frac{p(\omega_2)}{p(\omega_1)},则x\in\frac{\omega_1}{\omega_2}
$$

#### 基于最小错误

错误率：
$$
p(e) = \int_{-\infin}^{+\infin}p(e,x)\mathrm dx = \int_{-\infin}^{+\infin}p(e|x)p(x)\mathrm dx
$$

#### 基于最小风险

引入风险函数（损失函数）$\lambda(x)$

风险损失：采用决策$a_i$时的风险
$$
R(a_i|x)=E(\lambda(a_i,\omega_j))=\sum_{j=1}^c\lambda(a_i,\omega_j)p(\omega_j|x)
$$

### 多类情况贝叶斯决策规则

#### 判别函数

$g_i(x)$，一般选取$g_i(x)=\max_jg_j(x)$，则将$x$归于$\omega_i$类。

#### 决策面方程

$$
g_i(x) = g_j(x)
$$

![image-20210914102326475](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914102326475.png)

### 正态分布统计决策

最小错误率贝叶斯判别函数：
$$
g_i(x) = \ln p(x|\omega_i) + \ln p(\omega_i)
$$
带入正态分布：
$$
g_i(x) = -0.5(x-\mu_i)^T\Sigma_i^{-1}(x-\mu_i)-\frac{d}{2}\ln2\pi-0.5\ln|\Sigma_i|+\ln p(\omega_i)
$$
决策面方程：
$$
-0.5[(x-\mu_i)^T\Sigma_i^{-1}(x-\mu_i)-(x-\mu_j)^T\Sigma_j^{-1}(x-\mu_j)]-0.5\ln \frac{|\Sigma_i|}{|\Sigma_j|}+\ln\frac{p(\omega_i)}{p(\omega_j)}=0
$$
**几个特殊情况：**

1. $\Sigma_i=\sigma^2I$，则判别函数为：$-\frac{1}{2\sigma^2}(x-\mu_i)^T(x-\mu_i)+\ln p(\omega_i)$。若先验概率相等，直接等价于最小距离分类器。![image-20210914105907548](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914105907548.png)
2. 每一个协方差矩阵都相等，则判别函数为：$-\frac{1}{2\sigma^2}(x-\mu_i)^T(x-\mu_i)-\frac{d}{2}\ln 2\pi-0.5\ln \sigma^{2d}+\ln p(\omega_i)$式中$d$为维度。可简化为：$-\frac{1}{2\sigma^2}(x-\mu_i)^T\Sigma_i^{-1}(x-\mu_i)+\ln p(\omega_i)$![image-20210914105915313](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914105915313.png)
3. 若协方差矩阵各不相等：![image-20210914105955625](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914105955625.png)

