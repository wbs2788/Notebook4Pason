# 模式识别

## 贝叶斯决策理论

### 基本符号与定义

**决策**：根据观测到的x，利用先验和类条件概率决定x属于哪一类。

**Bayes决策:**
$$
p(\omega_i |x)=\frac{p(x|\omega_i)p(\omega_i)}{p(x)}
$$
**决策规则**
$$
p(\omega_i|x) = \max_{j=1,2}p(\omega_j|x),x\in \omega_i
$$
等价形式：
$$
p(x|\omega_i)p(\omega_i) = \max_{j=1,2}p(x|\omega_j)p(\omega_i)
$$


$$
若l(x)=\frac{p(x|\omega_1)}{p(x|\omega_2)}< \frac{p(\omega_2)}{p(\omega_1)},则x\in\frac{\omega_1}{\omega_2}
$$

#### 基于最小错误

错误率：
$$
p(e) = \int_{-\infin}^{+\infin}p(e,x)\mathrm dx = \int_{-\infin}^{+\infin}p(e|x)p(x)\mathrm dx
$$

#### 基于最小风险

引入风险函数（损失函数）$\lambda(x)$

风险损失：采用决策$a_i$时的风险
$$
R(a_i|x)=E(\lambda(a_i,\omega_j))=\sum_{j=1}^c\lambda(a_i,\omega_j)p(\omega_j|x)
$$

### 多类情况贝叶斯决策规则

#### 判别函数

$g_i(x)$，一般选取$g_i(x)=\max_jg_j(x)$，则将$x$归于$\omega_i$类。

#### 决策面方程

$$
g_i(x) = g_j(x)
$$

![image-20210914102326475](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914102326475.png)

### 正态分布统计决策

最小错误率贝叶斯判别函数：
$$
g_i(x) = \ln p(x|\omega_i) + \ln p(\omega_i)
$$
带入正态分布：
$$
g_i(x) = -0.5(x-\mu_i)^T\Sigma_i^{-1}(x-\mu_i)-\frac{d}{2}\ln2\pi-0.5\ln|\Sigma_i|+\ln p(\omega_i)
$$
决策面方程：
$$
-0.5[(x-\mu_i)^T\Sigma_i^{-1}(x-\mu_i)-(x-\mu_j)^T\Sigma_j^{-1}(x-\mu_j)]-0.5\ln \frac{|\Sigma_i|}{|\Sigma_j|}+\ln\frac{p(\omega_i)}{p(\omega_j)}=0
$$
**几个特殊情况：**

1. $\Sigma_i=\sigma^2I$，则判别函数为：$-\frac{1}{2\sigma^2}(x-\mu_i)^T(x-\mu_i)+\ln p(\omega_i)$。若先验概率相等，直接等价于最小距离分类器。![image-20210914105907548](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914105907548.png)
2. 每一个协方差矩阵都相等，则判别函数为：$-\frac{1}{2\sigma^2}(x-\mu_i)^T(x-\mu_i)-\frac{d}{2}\ln 2\pi-0.5\ln \sigma^{2d}+\ln p(\omega_i)$式中$d$为维度。可简化为：$-\frac{1}{2\sigma^2}(x-\mu_i)^T\Sigma_i^{-1}(x-\mu_i)+\ln p(\omega_i)$![image-20210914105915313](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914105915313.png)
3. 若协方差矩阵各不相等：![image-20210914105955625](C:\Users\surafce book2\AppData\Roaming\Typora\typora-user-images\image-20210914105955625.png)

## 概率密度函数的估计

### 基于样本的两步贝叶斯决策

- 利用样本集估计$P(\omega_i)$和$P(x|\omega_i)$
- 得到$\hat P(\omega_i)$和$\hat P(x|\omega_i)$
- 将估计量带入贝叶斯决策规则
- 得到决策结果

首先通过训练样本估计概率密度函数

- 先验概率估计-训练样本分布情况/根据领域知识认定
- 但类条件概率密度估计难

统计决策进行类别判定

- 训练样本有限，难以涵盖所有情况
- 但当训练样本多，就可以趋近于理论贝叶斯决策

### 概率密度估计方法

由训练样本集估计总体概率密度的方法可分为：

- 监督参数估计
- 非监督参数估计
- 非参数估计

### 参数估计的基本概念

统计量、参数空间

点估计：构造一个统计量作为某参数的估计

估计量、估计值、区间估计

### 概率密度估计的评估

无偏性：$\mathbb E\theta = \hat \theta$

渐进无偏：$N$趋于无穷有无偏性

有效性：一种估计比另一种方差小

一致估计
$$
\lim _{n\to\infin}p(|\hat{\theta_n}-\theta|>\epsilon) = 0
$$
则$\hat \theta$是$\theta$的一致估计

### 最大似然估计

#### 基本假设

- $\theta$确定但未知
- 每个样本i.i.d
- $p(x|\omega_j)$为已知分布，参数向量位置，且每个不同类别参数在函数上独立

#### 似然函数定义

$$
l(\theta) = p(x_1,x_2,\dots,x_N|\theta)=p(x_1|\theta)p(x_2|\theta)\dots p(x_N|\theta)
$$

也可以取对数

#### 求解

由于每个训练样本独立，可对概率乘积取对数，再求导。
$$
\forall i,\frac{\part}{\part \theta_i}\sum_{k=1}^N\log p(x_k|\theta^i) = 0
$$
注意：方程有可能有多解，但只有一个解最大。

#### 多维正态分布的最大似然估计

##### $\Sigma$已知，$\mu$未知，求$\mu$

$$
\mu = \hat \mu = \frac 1 N\sum_{k=1}^N x_k
$$

##### $\Sigma,\mu$均未知

$$
\hat \theta_1=\hat\mu_1=\frac 1 N \sum_{k=1}^Nx_k
$$

$$
\hat \theta_2=\hat  \sigma^2_1=\frac 1 N\sum_{k=1}^N(x_k-\hat\mu)^2
$$

### 贝叶斯估计和贝叶斯学习

贝叶斯估计实质：贝叶斯决策来决策参数的取值。

与最大似然估计的区别：

- 最大似然估计把待估计的参数当作未知但固定的量
- 贝叶斯估计把待估计的参数也看为随机变量

贝叶斯学习：把贝叶斯估计的原理用于直接从数据对概率密度函数进行迭代估计。

可以回顾[最小风险贝叶斯决策](#基于最小风险)

#### 贝叶斯估计量

$R(\hat\theta|x)$为给定$x$条件下估计量$\hat\theta$的期望损失，称为条件风险

定义：如果$\theta$的估计量$\hat \theta$使得条件风险最小，则为贝叶斯估计量。

#### 损失函数

损失函数有多种，最常见为平方误差：
$$
\lambda(\hat\theta,\theta)=(\hat\theta-\theta)^2
$$

#### 贝叶斯估计

定理：如果损失函数为二次函数，则贝叶斯估计量为给定$x$时$\theta$的条件期望：
$$
\hat\theta=\mathbb E[\theta|x] = \int_\Theta\theta p(\theta|x)\mathrm d\theta
$$

#### 估计基本步骤

1. 确定$\theta$的先验分布$p(\theta)$，待估参数为随机变量
2. 用第$i$类样本$X^i=(X_1,X_2,\dots，X_N)$求出样本的联合概率密度分布$p(X^i|\theta)$，是一个$\theta$的函数
3. 利用贝叶斯公式，求$\theta$的后验概率

$$
p(\theta|X^i)=\frac{p(X^i|\theta)p(\theta)}{\int p(X^i|\theta)p(\theta)\mathrm d \theta}
$$

4. 求贝叶斯估计

$$
\hat \theta=\int_\Theta\theta p(\theta|X^i)\mathrm d\theta
$$

这两种参数估计方法，最终目的是估计总体分布
$$
p(x|\Re) \ \Re\to X^i
$$
其实在第三步后可以直接通过联合密度求类条件概率密度
$$
p(x|X^i)\int p(x,\theta|X^i)\mathrm d\theta=\int p(x|\theta)p(\theta|X^i)\mathrm d\theta
$$

#### 非监督参数估计

在未知样本类别的条件下的参数估计称为**非监督参数估计**

几个基本假设

- 样本来自类数为$c$的各类中，但不知道每个样本究竟来自于哪一类
- 每类的先验概率$p(\omega_j)$已知
- 类条件概率密度的形式$p(x|\omega_j,\theta_j)$已知
- 未知的只是$c$个参数向量$\theta_1,\theta_2,\dots,\theta_c$的值

似然函数：
$$
l(\theta)=p(\Re|\theta)
$$


